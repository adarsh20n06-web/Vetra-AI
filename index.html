<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NOBLTY AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;margin:0;padding:0}
body{
    font-family:'Poppins',sans-serif;
    background:linear-gradient(135deg,#2b5876,#4e4376);
    color:white;
    min-height:100vh;
    padding:20px;
    display:flex;
    justify-content:center;
    align-items:flex-start;
}
body.light{background:linear-gradient(135deg,#fff,#e0e0e0);color:#333}

.logo{
    font-size:36px;font-weight:700;margin-bottom:12px;
    background:linear-gradient(45deg,#ffce00,#ff4f4f);
    -webkit-background-clip:text;color:transparent;
    text-align:center;
}
.tagline{text-align:center;opacity:.85;margin-bottom:18px}

.mode-toggle{
    position:absolute;top:20px;right:20px;
    background:#ffce00;border:none;padding:8px 12px;
    border-radius:8px;font-weight:600;cursor:pointer;
}

.container{width:100%;max-width:720px}

.card{
    background:rgba(255,255,255,.12);
    padding:24px;border-radius:16px;
    backdrop-filter:blur(12px);
    box-shadow:0 8px 30px rgba(0,0,0,.35);
}

body.light .card{background:rgba(255,255,255,.9)}

textarea{
    width:100%;padding:12px;border-radius:10px;
    border:none;outline:none;font-size:15px;
    margin-top:10px;
}

.ask-btn{
    width:100%;margin-top:10px;
    padding:14px;border:none;border-radius:10px;
    font-weight:600;font-size:16px;
    background:#ffce00;cursor:pointer;
}
.ask-btn:disabled{opacity:.6;cursor:not-allowed}

.login-btns{
    display:flex;flex-wrap:wrap;gap:8px;
    margin-bottom:10px;
}
.login-btns button{
    flex:1 1 30%;padding:10px;border-radius:8px;
    border:none;font-weight:600;cursor:pointer;
    color:white;
}
.google{background:#4285F4}
.microsoft{background:#f35325}
.zoho{background:#ff7a00}

#responseBox{
    margin-top:14px;
    background:rgba(255,255,255,.15);
    padding:12px;border-radius:10px;
    max-height:300px;overflow-y:auto;
    white-space:pre-wrap;
}
body.light #responseBox{background:rgba(0,0,0,.05)}

.response-entry{
    margin-bottom:10px;padding:8px;
    background:rgba(0,0,0,.25);
    border-radius:8px;position:relative;
}
body.light .response-entry{background:rgba(200,200,200,.4)}

.copy-btn{
    position:absolute;top:6px;right:6px;
    background:#ffce00;border:none;
    padding:4px 8px;border-radius:6px;
    font-size:12px;font-weight:600;
    cursor:pointer;
}

.notify{
    margin-top:10px;padding:10px;
    border-radius:8px;font-weight:500;
    display:none;
}
.notify.error{background:#ff4f4f}
.notify.success{background:#4caf50}

.typing{opacity:.7;font-style:italic}

@media(max-width:768px){
    .logo{font-size:28px}
}
@media(max-width:480px){
    .logo{font-size:24px}
}
</style>
</head>

<body>
<button class="mode-toggle" onclick="toggleMode()">Dark / Light</button>

<div class="container">
    <div class="logo">âš¡ NOBLTY AI</div>
    <div class="tagline">NOBLTY + aastrax | Smart Multilingual AI</div>

    <div class="card">
        <div class="login-btns" id="loginBtns">
            <button class="google" onclick="login('google')">Google</button>
            <button class="microsoft" onclick="login('microsoft')">Microsoft</button>
            <button class="zoho" onclick="login('zoho')">Zoho</button>
        </div>

        <textarea id="prompt" rows="4" placeholder="Ask something..." disabled></textarea>
        <button class="ask-btn" onclick="askAI()" disabled>Ask AI</button>

        <div class="notify" id="notifyBox"></div>
        <div id="responseBox"></div>
    </div>
</div>

<script>
const body=document.body;
const promptInput=document.getElementById("prompt");
const askBtn=document.querySelector(".ask-btn");
const responseBox=document.getElementById("responseBox");
const loginBtns=document.getElementById("loginBtns");
const notifyBox=document.getElementById("notifyBox");

if(localStorage.getItem("mode")==="light") body.classList.add("light");

function toggleMode(){
    body.classList.toggle("light");
    localStorage.setItem("mode",body.classList.contains("light")?"light":"dark");
}

function notify(msg,type){
    notifyBox.textContent=msg;
    notifyBox.className="notify "+type;
    notifyBox.style.display="block";
    setTimeout(()=>notifyBox.style.display="none",3000);
}

function login(p){ window.location.href="/login/"+p; }

function addEntry(text,typing=false){
    const div=document.createElement("div");
    div.className="response-entry";
    div.innerHTML=`<div class="${typing?'typing':''}">${text}</div>
    <button class="copy-btn" onclick="navigator.clipboard.writeText('${text.replace(/'/g,"\\'")}')">Copy</button>`;
    responseBox.appendChild(div);
    responseBox.scrollTop=responseBox.scrollHeight;
}

async function askAI(){
    const q=promptInput.value.trim();
    if(!q) return notify("Prompt required","error");

    addEntry("Thinking...",true);
    promptInput.disabled=true; askBtn.disabled=true;

    try{
        const r=await fetch("/ask",{
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({prompt:q})
        });
        if(r.status===403) throw "Login required";
        const d=await r.json();
        responseBox.lastChild.remove();
        addEntry(d.answer);
    }catch(e){
        responseBox.lastChild?.remove();
        notify(e,"error");
    }finally{
        promptInput.disabled=false; askBtn.disabled=false;
    }
}

/* REAL LOGIN CHECK */
(async()=>{
    try{
        const r=await fetch("/ask",{
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({prompt:"ping"})
        });
        if(r.status!==403){
            promptInput.disabled=false;
            askBtn.disabled=false;
            loginBtns.style.display="none";
        }
    }catch{}
})();
</script>
</body>
</html>
